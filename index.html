<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Intersection Observer 1</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet" type="text/css">
  <meta content="Bikeshed version 0aa2eb3dddf45f17630f6cfecbc54207812ef9db" name="generator">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
 <body class="h-entry">
  <div class="head">
   <header>
    <p data-fill-with="logo"><a href="https://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"></a> </p>
    <h1 class="p-name no-ref" id="title">Intersection Observer 1</h1>
    <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2016-11-14">14 November 2016</time></span></h2>
   </header>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://github.com/WICG/IntersectionObserver/">https://github.com/WICG/IntersectionObserver/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/IntersectionObserver/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mpb@google.com">Michael Blain</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2016 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification describes  an API that can be used to understand the visibility and position of DOM elements ("targets") relative to a containing element or to the top-level viewport ("root"). The position is delivered asynchronously and is useful for understanding the visibility of elements and implementing pre-loading and deferred loading of DOM content.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other
    documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this
    technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical
    reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="http://www.w3.org/2010/webperf/">Web Performance Working Group</a> as an Editors Draft. This document is intended to become a W3C Recommendation.

    Feedback and comments on this specification are welcome. Please use <a href="https://github.com/w3c/reporting/issues">Github issues</a>.
    Discussions may also be found in the <a href="http://lists.w3.org/Archives/Public/public-web-perf/">public-web-perf@w3.org archives</a>. </p>
   <p> Publication as an Editors Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/45211/status" rel="disclosure">public list of any
    patent disclosures</a> made in connection with the deliverables of the group; that page also
    includes instructions for disclosing a patent. An individual who has actual knowledge of a
    patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#intersection-observer-api"><span class="secno">2</span> <span class="content">Intersection Observer</span></a>
     <ol class="toc">
      <li><a href="#intersection-observer-callback"><span class="secno">2.1</span> <span class="content"> The IntersectionObserverCallback</span></a>
      <li><a href="#intersection-observer-interface"><span class="secno">2.2</span> <span class="content"> The IntersectionObserver interface</span></a>
      <li><a href="#intersection-observer-entry"><span class="secno">2.3</span> <span class="content"> The IntersectionObserverEntry interface</span></a>
      <li><a href="#intersection-observer-init"><span class="secno">2.4</span> <span class="content"> The IntersectionObserverInit dictionary</span></a>
     </ol>
    <li>
     <a href="#intersection-observer-processing-model"><span class="secno">3</span> <span class="content"> Processing Model</span></a>
     <ol class="toc">
      <li>
       <a href="#defines"><span class="secno">3.1</span> <span class="content"> Internal Slot Definitions</span></a>
       <ol class="toc">
        <li><a href="#document-defines"><span class="secno">3.1.1</span> <span class="content"> Document</span></a>
        <li><a href="#element-private-slots"><span class="secno">3.1.2</span> <span class="content"> Element</span></a>
        <li><a href="#intersection-observer-private-slots"><span class="secno">3.1.3</span> <span class="content"> IntersectionObserver</span></a>
       </ol>
      <li>
       <a href="#algorithms"><span class="secno">3.2</span> <span class="content"> Algorithms</span></a>
       <ol class="toc">
        <li><a href="#queue-intersection-observer-task"><span class="secno">3.2.1</span> <span class="content"> Queue an Intersection Observer Task</span></a>
        <li><a href="#notify-intersection-observers-algo"><span class="secno">3.2.2</span> <span class="content"> Notify Intersection Observers</span></a>
        <li><a href="#queue-intersection-observer-entry-algo"><span class="secno">3.2.3</span> <span class="content"> Queue an IntersectionObserverEntry</span></a>
        <li><a href="#calculate-intersection-rect-algo"><span class="secno">3.2.4</span> <span class="content"> Compute the Intersection of a Target Element and the Root</span></a>
        <li><a href="#update-intersection-observations-algo"><span class="secno">3.2.5</span> <span class="content"> Run the Update Intersection Observations Steps</span></a>
       </ol>
      <li><a href="#lifetime"><span class="secno">3.3</span> <span class="content"> IntersectionObserver Lifetime</span></a>
      <li>
       <a href="#external-spec-integrations"><span class="secno">3.4</span> <span class="content"> External Spec Integrations</span></a>
       <ol class="toc">
        <li><a href="#event-loop"><span class="secno">3.4.1</span> <span class="content"> HTML Processing Model: Event Loop</span></a>
       </ol>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>The web’s traditional position calculation mechanisms
rely on explicit queries of DOM state
that are known to cause (expensive) style recalculation and layout
and, frequently, are a source of significant performance overhead
due to continuous polling for this information.</p>
   <p>A body of common practice has evolved that relies on these behaviors,
however, including (but not limited to):</p>
   <ul>
    <li data-md="">
     <p>Building custom pre- and deferred-loading of DOM and data.</p>
    <li data-md="">
     <p>Implementing data-bound high-performance scrolling lists
which load and render subsets of data sets.
These lists are a central mobile interaction idiom.</p>
    <li data-md="">
     <p>Calculating element visibility.
In particular, <a href="http://www.iab.net/iablog/2014/03/viewability-has-arrived-what-you-need-to-know-to-see-through-this-sea-change.html"> ad networks now require reporting of ad "visibility" for monetizing impressions</a>. This has led to many sites abusing scroll handlers
(causing jank on scroll), <a href="http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html"> synchronous layout invoking readbacks</a> (causing unnecessary critical work in rAF loops),
and resorting to exotic plugin-based solutions for computing "true" element visibility (with all the associated overhead of the plugin architecture).</p>
   </ul>
   <p>These use-cases have several common properties:</p>
   <ol>
    <li data-md="">
     <p>They can be represented as passive "queries"
about the state of individual elements
with respect to some other element
(or the global viewport).</p>
    <li data-md="">
     <p>They do not impose hard latency requirements;
that is to say, the information can be delivered asynchronously
(e.g. from another thread)
without penalty.</p>
    <li data-md="">
     <p>They are poorly supported by nearly all combinations of existing web platform features,
requiring extraordinary developer effort despite their widespread use.</p>
   </ol>
   <p>A notable non-goal is pixel-accurate information about what was actually displayed
(which can be quite difficult to obtain efficiently in certain browser architectures
in the face of filters, webgl, and other features).
In all of these scenarios the information is useful
even when delivered at a slight delay
and without perfect compositing-result data.</p>
   <p>The Intersection Observer API addresses the above issues
by giving developers a new method to asynchronously query the position of an element
with respect to other elements or the global viewport.
The asynchronous delivery eliminates the need for costly DOM and style queries,
continuous polling,
and use of custom plugins.
By removing the need for these methods
it allows applications to significantly reduce their CPU, GPU and energy costs.</p>
   <div class="example" id="example-dfb36139">
    <a class="self-link" href="#example-dfb36139"></a> 
<pre class="highlight"><span class="kd">var</span> observer <span class="o">=</span> <span class="k">new</span> IntersectionObserver<span class="p">(</span>changes <span class="o">=></span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> change <span class="k">of</span> changes<span class="p">)</span> <span class="p">{</span>
    console<span class="p">.</span>log<span class="p">(</span>change<span class="p">.</span>time<span class="p">)</span><span class="p">;</span>               <span class="c1">// Timestamp when the change occurred
</span>    console<span class="p">.</span>log<span class="p">(</span>change<span class="p">.</span>rootBounds<span class="p">)</span><span class="p">;</span>         <span class="c1">// Unclipped area of root
</span>    console<span class="p">.</span>log<span class="p">(</span>change<span class="p">.</span>boundingClientRect<span class="p">)</span><span class="p">;</span> <span class="c1">// target.boundingClientRect()
</span>    console<span class="p">.</span>log<span class="p">(</span>change<span class="p">.</span>intersectionRect<span class="p">)</span><span class="p">;</span>   <span class="c1">// boundingClientRect, clipped by its containing block ancestors, and intersected with rootBounds
</span>    console<span class="p">.</span>log<span class="p">(</span>change<span class="p">.</span>intersectionRatio<span class="p">)</span><span class="p">;</span>  <span class="c1">// Ratio of intersectionRect area to boundingClientRect area
</span>    console<span class="p">.</span>log<span class="p">(</span>change<span class="p">.</span>target<span class="p">)</span><span class="p">;</span>             <span class="c1">// the Element target
</span>  <span class="p">}</span>
<span class="p">}</span><span class="p">,</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="c1">// Watch for intersection events on a specific target Element.
</span>observer<span class="p">.</span>observe<span class="p">(</span>target<span class="p">)</span><span class="p">;</span>

<span class="c1">// Stop watching for intersection events on a specific target Element.
</span>observer<span class="p">.</span>unobserve<span class="p">(</span>target<span class="p">)</span><span class="p">;</span>

<span class="c1">// Stop observing threshold events on all target elements.
</span>observer<span class="p">.</span>disconnect<span class="p">(</span><span class="p">)</span><span class="p">;</span>
</pre>
   </div>
   <h2 class="heading settled" data-level="2" id="intersection-observer-api"><span class="secno">2. </span><span class="content">Intersection Observer</span><a class="self-link" href="#intersection-observer-api"></a></h2>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="intersection-observer">Intersection Observer</dfn> API enables developers to understand the
visibility and position of <dfn class="dfn-paneled" data-dfn-for="IntersectionObserver" data-dfn-type="dfn" data-noexport="" id="intersectionobserver-target">target</dfn> DOM
elements relative to an <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-1">intersection root</a>.</p>
   <h3 class="heading settled" data-level="2.1" id="intersection-observer-callback"><span class="secno">2.1. </span><span class="content"> The IntersectionObserverCallback</span><a class="self-link" href="#intersection-observer-callback"></a></h3>
<pre class="idl highlight def"><span class="kt">callback</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="callback" data-export="" id="callbackdef-intersectionobservercallback">IntersectionObserverCallback</dfn> = <span class="kt">void</span> (<span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#intersectionobserverentry" id="ref-for-intersectionobserverentry-1">IntersectionObserverEntry</a>> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverCallback" data-dfn-type="argument" data-export="" id="dom-intersectionobservercallback-entries">entries<a class="self-link" href="#dom-intersectionobservercallback-entries"></a></dfn>, <a class="n" data-link-type="idl-name" href="#intersectionobserver" id="ref-for-intersectionobserver-1">IntersectionObserver</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverCallback" data-dfn-type="argument" data-export="" id="dom-intersectionobservercallback-observer">observer<a class="self-link" href="#dom-intersectionobservercallback-observer"></a></dfn>)
</pre>
   <p>This callback will be invoked when there are changes to <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-1">target</a>’s
intersection with the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-2">intersection root</a>, as per the <a data-link-type="dfn" href="#intersection-observer-processing-model" id="ref-for-intersection-observer-processing-model-1">processing model</a>.</p>
   <h3 class="heading settled" data-level="2.2" id="intersection-observer-interface"><span class="secno">2.2. </span><span class="content"> The IntersectionObserver interface</span><a class="self-link" href="#intersection-observer-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-2">IntersectionObserver</a></code> interface can be used to observe changes in the
intersection of an <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-3">intersection root</a> and one or more <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-2">target</a> <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code>s.</p>
   <p>An <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-3">IntersectionObserver</a></code> with a <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-1">root</a></code> <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> can
observe any <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-3">target</a> <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> that is a descendant of the <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-2">root</a></code> in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display/#containing-block-chain">containing block chain</a>.</p>
   <p>An <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-4">IntersectionObserver</a></code> with no <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-3">root</a></code> <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> will automatically observe intersections with the <a data-link-type="dfn" href="#intersectionobserver-implicit-root" id="ref-for-intersectionobserver-implicit-root-1">implicit root</a>,
and valid <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-4">targets</a> include any <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>, as well as any <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> in any <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-contexts">nested browsing contexts</a> inside the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>.</p>
   <p class="note" role="note">Note: In <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#mutationobserver">MutationObserver</a></code>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dictdef-mutationobserverinit">MutationObserverInit</a></code> options are passed
to <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-mutationobserver-observe">observe()</a></code> while in <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-5">IntersectionObserver</a></code> they are
passed to the constructor. This is because for MutationObserver, each <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#node">Node</a></code> being observed could have a different set of attributes to filter for. For <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-6">IntersectionObserver</a></code>, developers may choose to use a single observer to
track multiple targets using the same set of options; or they may use a different
observer for each tracked target.</p>
   <p><code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverinit-rootmargin" id="ref-for-dom-intersectionobserverinit-rootmargin-1">rootMargin</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverinit-threshold" id="ref-for-dom-intersectionobserverinit-threshold-1">threshold</a></code> values for each <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-5">target</a> seems to introduce more complexity without solving additional
use-cases. Per-<code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observe" id="ref-for-dom-intersectionobserver-observe-1">observe()</a></code> options could be provided in the future if V2
introduces a need for it.</p>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-intersectionobserver-intersectionobserver" id="ref-for-dom-intersectionobserver-intersectionobserver-1">Constructor</a>(<a class="n" data-link-type="idl-name" href="#callbackdef-intersectionobservercallback" id="ref-for-callbackdef-intersectionobservercallback-1">IntersectionObserverCallback</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserver/IntersectionObserver(callback, options)" data-dfn-type="argument" data-export="" id="dom-intersectionobserver-intersectionobserver-callback-options-callback">callback<a class="self-link" href="#dom-intersectionobserver-intersectionobserver-callback-options-callback"></a></dfn>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-intersectionobserverinit" id="ref-for-dictdef-intersectionobserverinit-1">IntersectionObserverInit</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserver/IntersectionObserver(callback, options)" data-dfn-type="argument" data-export="" id="dom-intersectionobserver-intersectionobserver-callback-options-options">options<a class="self-link" href="#dom-intersectionobserver-intersectionobserver-callback-options-options"></a></dfn>),
 <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<span class="n">Window</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intersectionobserver">IntersectionObserver</dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>? <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Element?" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-4">root</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-intersectionobserver-rootmargin" id="ref-for-dom-intersectionobserver-rootmargin-1">rootMargin</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">sequence</span>&lt;<span class="kt">double</span>> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="sequence<double>" href="#dom-intersectionobserver-thresholds" id="ref-for-dom-intersectionobserver-thresholds-1">thresholds</a>;
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-observe" id="ref-for-dom-intersectionobserver-observe-2">observe</a>(<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserver/observe(target)" data-dfn-type="argument" data-export="" id="dom-intersectionobserver-observe-target-target">target<a class="self-link" href="#dom-intersectionobserver-observe-target-target"></a></dfn>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-unobserve" id="ref-for-dom-intersectionobserver-unobserve-1">unobserve</a>(<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserver/unobserve(target)" data-dfn-type="argument" data-export="" id="dom-intersectionobserver-unobserve-target-target">target<a class="self-link" href="#dom-intersectionobserver-unobserve-target-target"></a></dfn>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-disconnect" id="ref-for-dom-intersectionobserver-disconnect-1">disconnect</a>();
  <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#intersectionobserverentry" id="ref-for-intersectionobserverentry-2">IntersectionObserverEntry</a>> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-takerecords" id="ref-for-dom-intersectionobserver-takerecords-1">takeRecords</a>();
};
</pre>
   <div>
    <dl>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="constructor" data-export="" data-lt="IntersectionObserver(callback, options)" id="dom-intersectionobserver-intersectionobserver"> new IntersectionObserver(callback, options)</dfn></p>
     <dd data-md="">
      <ol>
       <li data-md="">
        <p>Let <var>this</var> be a new <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-7">IntersectionObserver</a></code> object</p>
       <li data-md="">
        <p>Set <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-callback-slot" id="ref-for-dom-intersectionobserver-callback-slot-1">[[callback]]</a></code> slot to <var>callback</var>.</p>
       <li data-md="">
        <p>Set <var>this</var>.<var>root</var> to <var>options</var>.<var>root</var>.</p>
       <li data-md="">
        <p>Attempt to <a data-link-type="dfn" href="#parse-a-root-margin" id="ref-for-parse-a-root-margin-1">parse a root margin</a> from <var>options</var>.<var>rootMargin</var>.
If a list is returned,
set <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-rootmargin-slot" id="ref-for-dom-intersectionobserver-rootmargin-slot-1">[[rootMargin]]</a></code> slot to that.
Otherwise, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#dfn-simple-exception">SyntaxError</a></code> exception.</p>
       <li data-md="">
        <p>Let <var>thresholds</var> be a list equal to <var>options</var>.<var>threshold</var>.</p>
       <li data-md="">
        <p>If any value in <var>thresholds</var> is less than 0.0 or greater than
1.0, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#dfn-simple-exception">RangeError</a></code> exception.</p>
       <li data-md="">
        <p>Sort <var>thresholds</var> in ascending order.</p>
       <li data-md="">
        <p>If <var>thresholds</var> is empty, append <code>0</code> to <var>thresholds</var>.</p>
       <li data-md="">
        <p>Set <var>this</var>.<var>thresholds</var> to <var>thresholds</var>.</p>
       <li data-md="">
        <p>Return <var>this</var>.</p>
      </ol>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="method" data-export="" id="dom-intersectionobserver-observe">observe(target)</dfn></p>
     <dd data-md="">
      <ol>
       <li data-md="">
        <p>If <var>target</var> is in <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observationtargets-slot" id="ref-for-dom-intersectionobserver-observationtargets-slot-1">[[ObservationTargets]]</a></code> slot,
return.</p>
       <li data-md="">
        <p>Let <var>intersectionObserverRegistration</var> be
an <code class="idl"><a data-link-type="idl" href="#intersectionobserverregistration" id="ref-for-intersectionobserverregistration-1">IntersectionObserverRegistration</a></code> record
with an <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-observer" id="ref-for-dom-intersectionobserverregistration-observer-1">observer</a></code> property set to <var>this</var> and a <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-previousthreshold" id="ref-for-dom-intersectionobserverregistration-previousthreshold-1">previousThreshold</a></code> property set to <code>0</code>.</p>
       <li data-md="">
        <p>Append <var>intersectionObserverRegistration</var> to <var>target</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-element-registeredintersectionobservers-slot" id="ref-for-dom-element-registeredintersectionobservers-slot-1">[[RegisteredIntersectionObservers]]</a></code> slot.</p>
       <li data-md="">
        <p>Add <var>target</var> to <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observationtargets-slot" id="ref-for-dom-intersectionobserver-observationtargets-slot-2">[[ObservationTargets]]</a></code> slot.</p>
       <li data-md="">
        <p>Schedule an iteration of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop">event loop</a> in the <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-5">root</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a>.</p>
      </ol>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="method" data-export="" id="dom-intersectionobserver-unobserve">unobserve(target)</dfn></p>
     <dd data-md="">
      <ol>
       <li data-md="">
        <p>Remove the <code class="idl"><a data-link-type="idl" href="#intersectionobserverregistration" id="ref-for-intersectionobserverregistration-2">IntersectionObserverRegistration</a></code> record
whose <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-observer" id="ref-for-dom-intersectionobserverregistration-observer-2">observer</a></code> property is equal to <var>this</var> from <var>target</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-element-registeredintersectionobservers-slot" id="ref-for-dom-element-registeredintersectionobservers-slot-2">[[RegisteredIntersectionObservers]]</a></code> slot.</p>
       <li data-md="">
        <p>Remove <var>target</var> from <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observationtargets-slot" id="ref-for-dom-intersectionobserver-observationtargets-slot-3">[[ObservationTargets]]</a></code> slot.</p>
      </ol>
      <p class="note" role="note">Note: <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#mutationobserver">MutationObserver</a></code> does not implement <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-unobserve" id="ref-for-dom-intersectionobserver-unobserve-2">unobserve()</a></code>.
For <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-8">IntersectionObserver</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-unobserve" id="ref-for-dom-intersectionobserver-unobserve-3">unobserve()</a></code> addresses the
lazy-loading use case. After <var>target</var> becomes visible,
it does not need to be tracked.
It would be more work to either <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-disconnect" id="ref-for-dom-intersectionobserver-disconnect-2">disconnect()</a></code> all <var>target</var>s
and <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observe" id="ref-for-dom-intersectionobserver-observe-3">observe()</a></code> the remaining ones,
or create a separate <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-9">IntersectionObserver</a></code> for each <var>target</var>.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="method" data-export="" id="dom-intersectionobserver-disconnect">disconnect()</dfn></p>
     <dd data-md="">
      <p>For each <var>target</var> in <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observationtargets-slot" id="ref-for-dom-intersectionobserver-observationtargets-slot-4">[[ObservationTargets]]</a></code> slot:</p>
      <ol>
       <li data-md="">
        <p>Remove the <code class="idl"><a data-link-type="idl" href="#intersectionobserverregistration" id="ref-for-intersectionobserverregistration-3">IntersectionObserverRegistration</a></code> record
whose <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-observer" id="ref-for-dom-intersectionobserverregistration-observer-3">observer</a></code> property is equal to <var>this</var> from <var>target</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-element-registeredintersectionobservers-slot" id="ref-for-dom-element-registeredintersectionobservers-slot-3">[[RegisteredIntersectionObservers]]</a></code> slot.</p>
       <li data-md="">
        <p>Remove <var>target</var> from <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observationtargets-slot" id="ref-for-dom-intersectionobserver-observationtargets-slot-5">[[ObservationTargets]]</a></code> slot.</p>
      </ol>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="method" data-export="" id="dom-intersectionobserver-takerecords">takeRecords()</dfn></p>
     <dd data-md="">
      <ol>
       <li data-md="">
        <p>Let <var>queue</var> be a copy of <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-queuedentries-slot" id="ref-for-dom-intersectionobserver-queuedentries-slot-1">[[QueuedEntries]]</a></code> slot.</p>
       <li data-md="">
        <p>Clear <var>this</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-queuedentries-slot" id="ref-for-dom-intersectionobserver-queuedentries-slot-2">[[QueuedEntries]]</a></code> slot.</p>
       <li data-md="">
        <p>Return <var>queue</var>.</p>
      </ol>
    </dl>
   </div>
   <div>
    <dl>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-root">root</dfn>, <span> of type <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>, readonly, nullable</span></p>
     <dd data-md="">
      <p>The root <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> to use for intersection, or <code>null</code> if the
observer uses the <a data-link-type="dfn" href="#intersectionobserver-implicit-root" id="ref-for-intersectionobserver-implicit-root-2">implicit root</a>.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-rootmargin">rootMargin</dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, readonly</span></p>
     <dd data-md="">
      <p>Offsets applied to the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-4">intersection root’s</a> bounding box,
effectively growing or shrinking the box that is used to calculate intersections.
Note that <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-rootmargin" id="ref-for-dom-intersectionobserver-rootmargin-2">rootMargin</a></code> is only applied
for <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-6">targets</a> which belong to the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</a> as the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-5">intersection root</a>.</p>
      <p>On getting, return the result of serializing the elements of <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-rootmargin-slot" id="ref-for-dom-intersectionobserver-rootmargin-slot-2">[[rootMargin]]</a></code> space-separated, where pixel lengths serialize as the numeric value followed by "px",
and percentages serialize as the numeric value followed by "%".  Note that
this is not guaranteed to be identical to the <var>options</var>.<code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverinit-rootmargin" id="ref-for-dom-intersectionobserverinit-rootmargin-2">rootMargin</a></code> passed to the <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-10">IntersectionObserver</a></code> constructor.  If no <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverinit-rootmargin" id="ref-for-dom-intersectionobserverinit-rootmargin-3">rootMargin</a></code> was passed to the <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-11">IntersectionObserver</a></code> constructor, the value of this attribute is "0px 0px 0px 0px".</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-thresholds">thresholds</dfn>, <span> of type sequence&lt;<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-double">double</a>>, readonly</span></p>
     <dd data-md="">
      <p>A list of thresholds, sorted in increasing numeric order,
where each threshold is a ratio of intersection area to bounding box area
of an observed target.  Notifications for a target are generated when any
of the thresholds are crossed for that target.
If no <var>options</var>.<code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverinit-threshold" id="ref-for-dom-intersectionobserverinit-threshold-2">threshold</a></code> was provided to the <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-12">IntersectionObserver</a></code> constructor, the value of this attribute will be [0].</p>
    </dl>
   </div>
   <p>The <dfn class="dfn-paneled" data-dfn-for="IntersectionObserver" data-dfn-type="dfn" data-noexport="" id="intersectionobserver-intersection-root">intersection root</dfn> for an <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-13">IntersectionObserver</a></code> is the value of its <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-6">root</a></code> attribute,
or else the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-box/#viewport">viewport</a> (referred to as the <dfn class="dfn-paneled" data-dfn-for="IntersectionObserver" data-dfn-type="dfn" data-noexport="" id="intersectionobserver-implicit-root">implicit root</dfn>) if
the <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-7">root</a></code> attribute is <code>null</code>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-for="IntersectionObserver" data-dfn-type="dfn" data-noexport="" id="intersectionobserver-root-intersection-rectangle">root intersection rectangle</dfn> for an <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-14">IntersectionObserver</a></code> is the rectangle we’ll use to check against the targets.</p>
   <dl class="switch">
    <dt>If the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-6">intersection root</a> is the <a data-link-type="dfn" href="#intersectionobserver-implicit-root" id="ref-for-intersectionobserver-implicit-root-3">implicit root</a>, 
    <dd>it’s the viewport’s size. 
    <dt>If the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-7">intersection root</a> is a scrollable element, 
    <dd>it’s the element’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-box/#content-area">content area</a>. 
    <dt>Otherwise, 
    <dd>it’s the result of running the <code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-element-getboundingclientrect">getBoundingClientRect()</a></code> algorithm on the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-8">intersection root</a>. 
   </dl>
   <p>For any <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-7">target</a> which belongs to the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</a> as the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-9">intersection root</a>,
the rectangle is then expanded
according to the offsets in the <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-15">IntersectionObserver</a></code>’s <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-rootmargin-slot" id="ref-for-dom-intersectionobserver-rootmargin-slot-3">[[rootMargin]]</a></code> slot
in a manner similar to CSS’s <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css21/box.html#propdef-margin">margin</a> property,
with the four values indicating the amount the top, right, bottom, and left edges, respectively, are offset by,
with positive lengths indicating an outward offset.
Percentages are resolved relative to the width of the undilated rectangle.</p>
   <p class="note" role="note">Note: <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-rootmargin" id="ref-for-dom-intersectionobserver-rootmargin-3">rootMargin</a></code> only applies to the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-10">intersection root</a> itself.
If a <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-8">target</a> <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> is clipped by an ancestor other than the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-11">intersection root</a>, that clipping is unaffected by <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-rootmargin" id="ref-for-dom-intersectionobserver-rootmargin-4">rootMargin</a></code>.</p>
   <p class="note" role="note">Note: <a data-link-type="dfn" href="#intersectionobserver-root-intersection-rectangle" id="ref-for-intersectionobserver-root-intersection-rectangle-1">Root intersection rectangle</a> is not affected by <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-view-1/#pinch-zoom">pinch zoom</a> and will report the unadjusted <a data-link-type="dfn" href="https://drafts.csswg.org/css-box/#viewport">viewport</a>, consistent with the
intent of pinch zooming (to act like a magnifying glass and NOT change layout.)</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="parse-a-root-margin">parse a root margin</dfn> from an input string <var>marginString</var>,
returning either a list of 4 pixel lengths or percentages,
or failure:</p>
   <ol>
    <li data-md="">
     <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#parse-a-list-of-component-values">Parse a list of component values</a> <var>marginString</var>,
storing the result as <var>tokens</var>.</p>
    <li data-md="">
     <p>Remove all whitespace tokens from <var>tokens</var>.</p>
    <li data-md="">
     <p>If the length of <var>tokens</var> is 0 or greater than 4,
return failure.</p>
    <li data-md="">
     <p>Replace each <var>token</var> in <var>tokens</var>:</p>
     <ul>
      <li data-md="">
       <p>If <var>token</var> is an <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-3/#absolute-length">absolute length</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-3/#dimension">dimension</a> token,
replace it with a an equivalent pixel length.</p>
      <li data-md="">
       <p>If <var>token</var> is a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-3/#percentage-value">&lt;percentage></a> token,
replace it with an equivalent percentage.</p>
      <li data-md="">
       <p>Otherwise, return failure.</p>
     </ul>
    <li data-md="">
     <p>If there is one element in <var>tokens</var>,
append three duplicates of that element to <var>tokens</var>.
If there is two elements are <var>tokens</var>,
append a duplicate of each element to <var>tokens</var>.
If there are three elements in <var>tokens</var>,
append a duplicate of the second element to <var>tokens</var>.</p>
    <li data-md="">
     <p>Return <var>tokens</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="2.3" id="intersection-observer-entry"><span class="secno">2.3. </span><span class="content"> The IntersectionObserverEntry interface</span><a class="self-link" href="#intersection-observer-entry"></a></h3>
<pre class="idl highlight def">[<dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="constructor" data-export="" data-lt="IntersectionObserverEntry(intersectionObserverEntryInit)" id="dom-intersectionobserverentry-intersectionobserverentry">Constructor<a class="self-link" href="#dom-intersectionobserverentry-intersectionobserverentry"></a></dfn>(<a class="n" data-link-type="idl-name" href="#dictdef-intersectionobserverentryinit" id="ref-for-dictdef-intersectionobserverentryinit-1">IntersectionObserverEntryInit</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntry/IntersectionObserverEntry(intersectionObserverEntryInit)" data-dfn-type="argument" data-export="" id="dom-intersectionobserverentry-intersectionobserverentry-intersectionobserverentryinit-intersectionobserverentryinit">intersectionObserverEntryInit<a class="self-link" href="#dom-intersectionobserverentry-intersectionobserverentry-intersectionobserverentryinit-intersectionobserverentryinit"></a></dfn>)]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intersectionobserverentry">IntersectionObserverEntry</dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMHighResTimeStamp" href="#dom-intersectionobserverentry-time" id="ref-for-dom-intersectionobserverentry-time-1">time</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMRectReadOnly" href="#dom-intersectionobserverentry-rootbounds" id="ref-for-dom-intersectionobserverentry-rootbounds-1">rootBounds</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMRectReadOnly" href="#dom-intersectionobserverentry-boundingclientrect" id="ref-for-dom-intersectionobserverentry-boundingclientrect-1">boundingClientRect</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMRectReadOnly" href="#dom-intersectionobserverentry-intersectionrect" id="ref-for-dom-intersectionobserverentry-intersectionrect-1">intersectionRect</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">double</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="double" href="#dom-intersectionobserverentry-intersectionratio" id="ref-for-dom-intersectionobserverentry-intersectionratio-1">intersectionRatio</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Element" href="#dom-intersectionobserverentry-target" id="ref-for-dom-intersectionobserverentry-target-1">target</a>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-intersectionobserverentryinit">IntersectionObserverEntryInit</dfn> {
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntryInit" data-dfn-type="dict-member" data-export="" data-type="DOMHighResTimeStamp " id="dom-intersectionobserverentryinit-time">time<a class="self-link" href="#dom-intersectionobserverentryinit-time"></a></dfn>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntryInit" data-dfn-type="dict-member" data-export="" data-type="DOMRectInit " id="dom-intersectionobserverentryinit-rootbounds">rootBounds<a class="self-link" href="#dom-intersectionobserverentryinit-rootbounds"></a></dfn>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntryInit" data-dfn-type="dict-member" data-export="" data-type="DOMRectInit " id="dom-intersectionobserverentryinit-boundingclientrect">boundingClientRect<a class="self-link" href="#dom-intersectionobserverentryinit-boundingclientrect"></a></dfn>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntryInit" data-dfn-type="dict-member" data-export="" data-type="DOMRectInit " id="dom-intersectionobserverentryinit-intersectionrect">intersectionRect<a class="self-link" href="#dom-intersectionobserverentryinit-intersectionrect"></a></dfn>;
  <span class="kt">required</span> <span class="kt">double</span> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntryInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-intersectionobserverentryinit-intersectionratio">intersectionRatio<a class="self-link" href="#dom-intersectionobserverentryinit-intersectionratio"></a></dfn>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <dfn class="nv idl-code" data-dfn-for="IntersectionObserverEntryInit" data-dfn-type="dict-member" data-export="" data-type="Element " id="dom-intersectionobserverentryinit-target">target<a class="self-link" href="#dom-intersectionobserverentryinit-target"></a></dfn>;
};
</pre>
   <div>
    <dl>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverentry-boundingclientrect">boundingClientRect</dfn>, <span> of type <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a>, readonly</span></p>
     <dd data-md="">
      <p>A <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a></code> obtained by running the <code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-element-getboundingclientrect">getBoundingClientRect()</a></code> algorithm
on the <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-target" id="ref-for-dom-intersectionobserverentry-target-2">target</a></code>.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverentry-intersectionrect">intersectionRect</dfn>, <span> of type <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a>, readonly</span></p>
     <dd data-md="">
      <p><code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-boundingclientrect" id="ref-for-dom-intersectionobserverentry-boundingclientrect-2">boundingClientRect</a></code>, intersected by
each of <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-target" id="ref-for-dom-intersectionobserverentry-target-3">target</a></code>'s ancestors' clip
rects (up to but not including <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-8">root</a></code>),
intersected with the <a data-link-type="dfn" href="#intersectionobserver-root-intersection-rectangle" id="ref-for-intersectionobserver-root-intersection-rectangle-2">root intersection rectangle</a>.
This value represents the portion of <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-target" id="ref-for-dom-intersectionobserverentry-target-4">target</a></code> actually visible
within the <a data-link-type="dfn" href="#intersectionobserver-root-intersection-rectangle" id="ref-for-intersectionobserver-root-intersection-rectangle-3">root intersection rectangle</a>.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverentry-intersectionratio">intersectionRatio</dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-double">double</a>, readonly</span></p>
     <dd data-md="">
      <p>Ratio of <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-intersectionrect" id="ref-for-dom-intersectionobserverentry-intersectionrect-2">intersectionRect</a></code> area to <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-boundingclientrect" id="ref-for-dom-intersectionobserverentry-boundingclientrect-3">boundingClientRect</a></code> area.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverentry-rootbounds">rootBounds</dfn>, <span> of type <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a>, readonly</span></p>
     <dd data-md="">
      <p>If <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-target" id="ref-for-dom-intersectionobserverentry-target-5">target</a></code> belongs to the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</a> as the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-12">intersection root</a>,
this will be the <a data-link-type="dfn" href="#intersectionobserver-root-intersection-rectangle" id="ref-for-intersectionobserver-root-intersection-rectangle-4">root intersection rectangle</a>.
Otherwise, this will be <code>null</code>.
Note that if the target is in a different <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a> than the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-13">intersection root</a>,
this will be in a different coordinate system
than <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-boundingclientrect" id="ref-for-dom-intersectionobserverentry-boundingclientrect-4">boundingClientRect</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverentry-intersectionrect" id="ref-for-dom-intersectionobserverentry-intersectionrect-3">intersectionRect</a></code>.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverentry-target">target</dfn>, <span> of type <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>, readonly</span></p>
     <dd data-md="">
      <p>The <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> whose intersection with the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-14">intersection root</a> changed.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverEntry" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverentry-time">time</dfn>, <span> of type <a data-link-type="idl-name" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a>, readonly</span></p>
     <dd data-md="">
      <p>The attribute must return a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a></code> that corresponds to the time the intersection was recorded, relative to the <a data-link-type="dfn" href="http://www.w3.org/TR/hr-time/#time-origin">time origin</a> of the global object associated with the IntersectionObserver instance
that generated the notification.</p>
    </dl>
   </div>
   <h3 class="heading settled" data-level="2.4" id="intersection-observer-init"><span class="secno">2.4. </span><span class="content"> The IntersectionObserverInit dictionary</span><a class="self-link" href="#intersection-observer-init"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-intersectionobserverinit">IntersectionObserverInit</dfn> {
  <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>?  <a class="nv idl-code" data-default="null" data-link-type="dict-member" data-type="Element?  " href="#dom-intersectionobserverinit-root" id="ref-for-dom-intersectionobserverinit-root-1">root</a> = <span class="kt">null</span>;
  <span class="kt">DOMString</span> <a class="nv idl-code" data-default="&quot;0px&quot;" data-link-type="dict-member" data-type="DOMString " href="#dom-intersectionobserverinit-rootmargin" id="ref-for-dom-intersectionobserverinit-rootmargin-4">rootMargin</a> = "0px";
  (<span class="kt">double</span> <span class="kt">or</span> <span class="kt">sequence</span>&lt;<span class="kt">double</span>>) <a class="nv idl-code" data-default="0" data-link-type="dict-member" data-type="(double or sequence<double>) " href="#dom-intersectionobserverinit-threshold" id="ref-for-dom-intersectionobserverinit-threshold-3">threshold</a> = 0;
};
</pre>
   <div>
    <dl>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverInit" data-dfn-type="dict-member" data-export="" id="dom-intersectionobserverinit-root">root</dfn>, <span> of type <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>, nullable, defaulting to <code>null</code></span></p>
     <dd data-md="">
      <p>The <var>root</var> to use for intersection.
If not provided, use the <a data-link-type="dfn" href="#intersectionobserver-implicit-root" id="ref-for-intersectionobserver-implicit-root-4">implicit root</a>.</p>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverInit" data-dfn-type="dict-member" data-export="" id="dom-intersectionobserverinit-rootmargin">rootMargin</dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, defaulting to <code>"0px"</code></span></p>
     <dd data-md="">
      <p>Similar to the CSS <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css21/box.html#propdef-margin">margin</a> property,
this is a string of 1-4 components,
each either an <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-3/#absolute-length">absolute length</a> or a percentage.</p>
<pre class="example highlight" id="example-825b82c7"><a class="self-link" href="#example-825b82c7"></a><span class="s2">"5px"</span>                <span class="c1">// all margins set to 5px
</span><span class="s2">"5px 10px"</span>           <span class="c1">// top &amp; bottom = 5px, right &amp; left = 10px
</span><span class="s2">"-10px 5px 8px"</span>      <span class="c1">// top = -10px, right &amp; left = 5px, bottom = 8px
</span><span class="s2">"-10px -5px 5px 8px"</span> <span class="c1">// top = -10px, right = -5px, bottom = 5px, left = 8px
</span></pre>
     <dt data-md="">
      <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverInit" data-dfn-type="dict-member" data-export="" id="dom-intersectionobserverinit-threshold">threshold</dfn>, <span> of type <code class="idl-code">(double or sequence&lt;double>)</code>, defaulting to <code>0</code></span></p>
     <dd data-md="">
      <p>List of threshold(s) at which to trigger callback.
callback will be invoked when intersectionRect’s area changes from
greater than or equal to any threshold to less than that threshold,
and vice versa.</p>
      <p>Threshold values must be in the range of [0, 1.0] and represent a
percentage of the area of the rectangle produced
by running the <code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-element-getboundingclientrect">getBoundingClientRect()</a></code> algorithm
on the <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-9">target</a>.</p>
      <p class="note" role="note">Note: 0.0 is effectively "any non-zero number of pixels".</p>
    </dl>
   </div>
   <h2 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="3" data-lt="Processing Model" data-noexport="" id="intersection-observer-processing-model"><span class="secno">3. </span><span class="content"> Processing Model</span></h2>
   <p>This section outlines the steps the user agent must take when implementing
the <a data-link-type="dfn" href="#intersection-observer" id="ref-for-intersection-observer-1">Intersection Observer</a> API.</p>
   <h3 class="heading settled" data-level="3.1" id="defines"><span class="secno">3.1. </span><span class="content"> Internal Slot Definitions</span><a class="self-link" href="#defines"></a></h3>
   <h4 class="heading settled" data-level="3.1.1" id="document-defines"><span class="secno">3.1.1. </span><span class="content"> Document</span><a class="self-link" href="#document-defines"></a></h4>
   <p>Each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> has an <dfn class="dfn-paneled" data-dfn-for="Document" data-dfn-type="dfn" data-noexport="" id="document-intersectionobservertaskqueued">IntersectionObserverTaskQueued</dfn> flag
which is initialized to false.</p>
   <h4 class="heading settled" data-level="3.1.2" id="element-private-slots"><span class="secno">3.1.2. </span><span class="content"> Element</span><a class="self-link" href="#element-private-slots"></a></h4>
   <p><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> objects have an internal <dfn class="dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="attribute" data-export="" id="dom-element-registeredintersectionobservers-slot">[[RegisteredIntersectionObservers]]</dfn> slot,
which is initialized to an empty list.
This list holds <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intersectionobserverregistration">IntersectionObserverRegistration</dfn> records,
which have an <dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverRegistration" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverregistration-observer">observer</dfn> property
holding an <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-16">IntersectionObserver</a></code> and a <dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserverRegistration" data-dfn-type="attribute" data-export="" id="dom-intersectionobserverregistration-previousthreshold">previousThreshold</dfn> property
holding a number between 0 and the length of the observer’s <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-thresholds" id="ref-for-dom-intersectionobserver-thresholds-2">thresholds</a></code> property (inclusive).</p>
   <h4 class="heading settled" data-level="3.1.3" id="intersection-observer-private-slots"><span class="secno">3.1.3. </span><span class="content"> IntersectionObserver</span><a class="self-link" href="#intersection-observer-private-slots"></a></h4>
   <p><code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-17">IntersectionObserver</a></code> objects have internal <dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-queuedentries-slot">[[QueuedEntries]]</dfn> and <dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-observationtargets-slot">[[ObservationTargets]]</dfn> slots,
which are initialized to empty lists and an internal <dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-callback-slot">[[callback]]</dfn> slot
which is initialized by <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-intersectionobserver" id="ref-for-dom-intersectionobserver-intersectionobserver-2">IntersectionObserver(callback, options)</a></code>.
They also have an internal <dfn class="dfn-paneled idl-code" data-dfn-for="IntersectionObserver" data-dfn-type="attribute" data-export="" id="dom-intersectionobserver-rootmargin-slot">[[rootMargin]]</dfn> slot
which is a list of four pixel lengths or percentages.</p>
   <h3 class="heading settled" data-level="3.2" id="algorithms"><span class="secno">3.2. </span><span class="content"> Algorithms</span><a class="self-link" href="#algorithms"></a></h3>
   <h4 class="heading settled" data-level="3.2.1" id="queue-intersection-observer-task"><span class="secno">3.2.1. </span><span class="content"> Queue an Intersection Observer Task</span><a class="self-link" href="#queue-intersection-observer-task"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="queue-an-intersection-observer-task">queue an intersection observer task</dfn> for a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> <var>document</var>,
run these steps:</p>
   <ol>
    <li data-md="">
     <p>If <var>document</var>’s <a data-link-type="dfn" href="#document-intersectionobservertaskqueued" id="ref-for-document-intersectionobservertaskqueued-1">IntersectionObserverTaskQueued</a> flag is set to true,
return.</p>
    <li data-md="">
     <p>Set <var>document</var>’s <a data-link-type="dfn" href="#document-intersectionobservertaskqueued" id="ref-for-document-intersectionobservertaskqueued-2">IntersectionObserverTaskQueued</a> flag to true.</p>
    <li data-md="">
     <p>Enqueue a task to <a data-link-type="dfn" href="#notify-intersection-observers" id="ref-for-notify-intersection-observers-1">notify intersection observers</a> in the <a data-link-type="dfn" href="http://w3c.github.io/requestidlecallback/#dfn-list-of-idle-request-callbacks">list of idle request callbacks</a> with a <var>timeout</var> of 100.</p>
     <p class="issue" id="issue-bf9a6e46"><a class="self-link" href="#issue-bf9a6e46"></a> Should we use something other than 100ms as <var>timeout</var>?</p>
     <p class="issue" id="issue-f67f2718"><a class="self-link" href="#issue-f67f2718"></a> Should we consider making this just post a task instead?</p>
   </ol>
   <h4 class="heading settled" data-level="3.2.2" id="notify-intersection-observers-algo"><span class="secno">3.2.2. </span><span class="content"> Notify Intersection Observers</span><a class="self-link" href="#notify-intersection-observers-algo"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="notify-intersection-observers">notify intersection observers</dfn> for a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> <var>document</var>,
run these steps:</p>
   <ol>
    <li data-md="">
     <p>Set <var>document</var>’s <a data-link-type="dfn" href="#document-intersectionobservertaskqueued" id="ref-for-document-intersectionobservertaskqueued-3">IntersectionObserverTaskQueued</a> flag to false.</p>
    <li data-md="">
     <p>Let <var>notify list</var> be a list of all <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-18">IntersectionObserver</a></code>s
whose <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-9">root</a></code> is in the DOM tree of <var>document</var>.</p>
    <li data-md="">
     <p>For each <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-19">IntersectionObserver</a></code> object <var>observer</var> in <var>notify list</var>,
run these steps:</p>
     <ol>
      <li data-md="">
       <p>If <var>observer</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-queuedentries-slot" id="ref-for-dom-intersectionobserver-queuedentries-slot-3">[[QueuedEntries]]</a></code> slot is empty,
continue.</p>
      <li data-md="">
       <p>Let <var>queue</var> be a copy of <var>observer</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-queuedentries-slot" id="ref-for-dom-intersectionobserver-queuedentries-slot-4">[[QueuedEntries]]</a></code> slot.</p>
      <li data-md="">
       <p>Clear <var>observer</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-queuedentries-slot" id="ref-for-dom-intersectionobserver-queuedentries-slot-5">[[QueuedEntries]]</a></code> slot.</p>
      <li data-md="">
       <p>Invoke <var>callback</var> with <var>queue</var> as the first argument and <var>observer</var> as the second argument and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#dfn-callback-this-value">callback this value</a>.
If this throws an exception, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#report-the-exception">report the exception</a>.</p>
     </ol>
   </ol>
   <h4 class="heading settled" data-level="3.2.3" id="queue-intersection-observer-entry-algo"><span class="secno">3.2.3. </span><span class="content"> Queue an IntersectionObserverEntry</span><a class="self-link" href="#queue-intersection-observer-entry-algo"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="queue-an-intersectionobserverentry">queue an IntersectionObserverEntry</dfn> for an <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-20">IntersectionObserver</a></code> <var>observer</var>, given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> <var>document</var>; <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a></code> <var>time</var>; <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#domrect">DOMRect</a></code>s <var>rootBounds</var>, <var>boundingClientRect</var>, and <var>intersectionRect</var>;
and an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> <var>target</var>;
run these steps:</p>
   <ol>
    <li data-md="">
     <p>Construct an <code class="idl"><a data-link-type="idl" href="#intersectionobserverentry" id="ref-for-intersectionobserverentry-3">IntersectionObserverEntry</a></code>, passing in <var>time</var>, <var>rootBounds</var>, <var>boundingClientRect</var>, <var>intersectionRect</var> and <var>target</var>.</p>
    <li data-md="">
     <p>Append it to <var>observer</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-queuedentries-slot" id="ref-for-dom-intersectionobserver-queuedentries-slot-6">[[QueuedEntries]]</a></code> slot.</p>
    <li data-md="">
     <p><a data-link-type="dfn" href="#queue-an-intersection-observer-task" id="ref-for-queue-an-intersection-observer-task-1">Queue an intersection observer task</a> for <var>document</var>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.2.4" id="calculate-intersection-rect-algo"><span class="secno">3.2.4. </span><span class="content"> Compute the Intersection of a Target Element and the Root</span><a class="self-link" href="#calculate-intersection-rect-algo"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="compute-the-intersection">compute the intersection</dfn> between a <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-10">target</a> and the observer’s <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-15">intersection root</a>,
run these steps:</p>
   <ol>
    <li data-md="">
     <p>Let <var>intersectionRect</var> be the result of running the <code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-element-getboundingclientrect">getBoundingClientRect()</a></code> algorithm on the <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-11">target</a>.</p>
    <li data-md="">
     <p>Let <var>container</var> be the parent node of the <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-12">target</a>.</p>
    <li data-md="">
     <p>While <var>container</var> is not the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-16">intersection root</a>:</p>
     <ol>
      <li data-md="">
       <p>Map <var>intersectionRect</var> to the coordinate space of <var>container</var>.</p>
      <li data-md="">
       <p>If <var>container</var> has overflow clipping or a css <a data-link-type="dfn" href="http://www.w3.org/TR/css-masking-1/#propdef-clip-path">clip-path</a> property,
update <var>intersectionRect</var> by applying <var>container</var>’s clip.</p>
      <li data-md="">
       <p>If <var>container</var> is the root element of a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-contexts">nested browsing context</a>,
update <var>container</var> to be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container">browsing context container</a> of <var>container</var>.
Otherwise, update <var>container</var> to be the parent node of <var>container</var>.</p>
     </ol>
    <li data-md="">
     <p>Map <var>intersectionRect</var> to the coordinate space of the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-17">intersection root</a>.</p>
    <li data-md="">
     <p>Update <var>intersectionRect</var> by intersecting it with the <a data-link-type="dfn" href="#intersectionobserver-root-intersection-rectangle" id="ref-for-intersectionobserver-root-intersection-rectangle-5">root intersection rectangle</a>.</p>
    <li data-md="">
     <p>Map <var>intersectionRect</var> to the coordinate space of the viewport of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> containing the <a data-link-type="dfn" href="#intersectionobserver-target" id="ref-for-intersectionobserver-target-13">target</a>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.2.5" id="update-intersection-observations-algo"><span class="secno">3.2.5. </span><span class="content"> Run the Update Intersection Observations Steps</span><a class="self-link" href="#update-intersection-observations-algo"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="run-the-update-intersection-observations-steps">run the update intersection observations steps</dfn> for a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> <var>document</var> given a timestamp <var>time</var>, run these steps:</p>
   <ol>
    <li data-md="">
     <p>Let <var>observer list</var> be a list of all <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-21">IntersectionObserver</a></code>s
whose <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-10">root</a></code> is in the DOM tree of <var>document</var>.</p>
    <li data-md="">
     <p>For each <var>observer</var> in <var>observer list</var>:</p>
     <ol>
      <li data-md="">
       <p>Let <var>rootBounds</var> be <var>observer</var>’s <a data-link-type="dfn" href="#intersectionobserver-root-intersection-rectangle" id="ref-for-intersectionobserver-root-intersection-rectangle-6">root intersection rectangle</a>.</p>
      <li data-md="">
       <p>For each <var>target</var> in <var>observer</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observationtargets-slot" id="ref-for-dom-intersectionobserver-observationtargets-slot-6">[[ObservationTargets]]</a></code> slot, processed in the same order that <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-observe" id="ref-for-dom-intersectionobserver-observe-4">observe()</a></code> was called on each <var>target</var>:</p>
       <ol>
        <li data-md="">
         <p>If the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-18">intersection root</a> is not the <a data-link-type="dfn" href="#intersectionobserver-implicit-root" id="ref-for-intersectionobserver-implicit-root-5">implicit root</a> and <var>target</var> is not a descendant of the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-19">intersection root</a> in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display/#containing-block-chain">containing block chain</a>,
skip further processing for <var>target</var>.</p>
        <li data-md="">
         <p>If the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-20">intersection root</a> is not the <a data-link-type="dfn" href="#intersectionobserver-implicit-root" id="ref-for-intersectionobserver-implicit-root-6">implicit root</a>,
and <var>target</var> is not in the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> as the <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-21">intersection root</a>,
skip further processing for <var>target</var>.</p>
        <li data-md="">
         <p>Let <var>targetRect</var> be a <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a></code> obtained
by running the <code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-element-getboundingclientrect">getBoundingClientRect()</a></code> algorithm on <var>target</var>.</p>
        <li data-md="">
         <p>Let <var>intersectionRect</var> be the result of running the <a data-link-type="dfn" href="#compute-the-intersection" id="ref-for-compute-the-intersection-1">compute the intersection</a> algorithm on <var>target</var>.</p>
        <li data-md="">
         <p>Let <var>targetArea</var> be <var>targetRect</var>’s area.</p>
        <li data-md="">
         <p>Let <var>intersectionArea</var> be <var>intersectionRect</var>’s area.</p>
        <li data-md="">
         <p>Let <var>intersectionRatio</var> be <var>intersectionArea</var> divided by <var>targetArea</var> if <var>targetArea</var> is non-zero,
and <code>0</code> otherwise.</p>
        <li data-md="">
         <p>If <var>intersectionRatio</var> is equal to <code>0</code>,
let <var>threshold</var> be <code>0</code>.
If <var>intersectionRatio</var> is equal to <code>1</code>,
let <var>threshold</var> be the length of <var>observer</var>.<code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-thresholds" id="ref-for-dom-intersectionobserver-thresholds-3">thresholds</a></code>.
Otherwise, let <var>threshold</var> be the index of the first entry in <var>observer</var>.<code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-thresholds" id="ref-for-dom-intersectionobserver-thresholds-4">thresholds</a></code> whose value is greater than <var>intersectionRatio</var>.</p>
        <li data-md="">
         <p>Let <var>intersectionObserverRegistration</var> be the <code class="idl"><a data-link-type="idl" href="#intersectionobserverregistration" id="ref-for-intersectionobserverregistration-4">IntersectionObserverRegistration</a></code> record
in <var>target</var>’s internal <code class="idl"><a data-link-type="idl" href="#dom-element-registeredintersectionobservers-slot" id="ref-for-dom-element-registeredintersectionobservers-slot-4">[[RegisteredIntersectionObservers]]</a></code> slot
whose <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-observer" id="ref-for-dom-intersectionobserverregistration-observer-4">observer</a></code> property is equal to <var>observer</var>.</p>
        <li data-md="">
         <p>Let <var>previousThreshold</var> be set to <var>intersectionObserverRegistration</var>’s <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-previousthreshold" id="ref-for-dom-intersectionobserverregistration-previousthreshold-2">previousThreshold</a></code> property.</p>
        <li data-md="">
         <p>If <var>threshold</var> does not equal <var>previousThreshold</var>, <a data-link-type="dfn" href="#queue-an-intersectionobserverentry" id="ref-for-queue-an-intersectionobserverentry-1">queue an IntersectionObserverEntry</a>,
passing in <var>observer</var>, <var>time</var>, <var>rootBounds</var>, <var>boundingClientRect</var>, <var>intersectionRect</var> and <var>target</var>.</p>
        <li data-md="">
         <p>Assign <var>threshold</var> to <var>intersectionObserverRegistration</var>’s <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserverregistration-previousthreshold" id="ref-for-dom-intersectionobserverregistration-previousthreshold-3">previousThreshold</a></code> property.</p>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="3.3" id="lifetime"><span class="secno">3.3. </span><span class="content"> IntersectionObserver Lifetime</span><a class="self-link" href="#lifetime"></a></h3>
   <p>An <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-22">IntersectionObserver</a></code> will remain alive until both of these conditions hold:</p>
   <ul>
    <li>There are no scripting references to the observer.
    <li>The observer is not observing any targets. 
   </ul>
   <p>An <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-23">IntersectionObserver</a></code> will continue observing a target until any of the following occurs:</p>
   <ul>
    <li><code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-unobserve" id="ref-for-dom-intersectionobserver-unobserve-4">unobserve(target)</a></code> is called on the target.
    <li><code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-disconnect" id="ref-for-dom-intersectionobserver-disconnect-3">disconnect()</a></code> is called.
    <li>The target <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element">Element</a></code> is deleted.
    <li>The observer’s <a data-link-type="dfn" href="#intersectionobserver-intersection-root" id="ref-for-intersectionobserver-intersection-root-22">intersection root</a> is deleted. 
   </ul>
   <h3 class="heading settled" data-level="3.4" id="external-spec-integrations"><span class="secno">3.4. </span><span class="content"> External Spec Integrations</span><a class="self-link" href="#external-spec-integrations"></a></h3>
   <h4 class="heading settled" data-level="3.4.1" id="event-loop"><span class="secno">3.4.1. </span><span class="content"> HTML Processing Model: Event Loop</span><a class="self-link" href="#event-loop"></a></h4>
   <p>An <a data-link-type="dfn" href="#intersection-observer" id="ref-for-intersection-observer-2">Intersection Observer</a> processing step should take place
during the "<i>Update the rendering</i>" steps,
after step 9, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#run-the-fullscreen-rendering-steps">run the fullscreen rendering steps</a>,
and before step 10, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#run-the-animation-frame-callbacks">run the animation frame callbacks</a>,
in the in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#processing-model-8">HTML Processing Model</a>.</p>
   <p>This step is:</p>
   <ol start="10">
    <li>For each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">fully active</a> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a> in <var>docs</var>, <a data-link-type="dfn" href="#run-the-update-intersection-observations-steps" id="ref-for-run-the-update-intersection-observations-steps-1">Run the update intersection observations steps</a> for each <code class="idl"><a data-link-type="idl" href="#intersectionobserver" id="ref-for-intersectionobserver-24">IntersectionObserver</a></code> whose <code class="idl"><a data-link-type="idl" href="#dom-intersectionobserver-root" id="ref-for-dom-intersectionobserver-root-11">root</a></code> is in the DOMtree of that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">Document</a>.
   </ol>
  </main>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li>
    boundingClientRect
    <ul>
     <li><a href="#dom-intersectionobserverentryinit-boundingclientrect">dict-member for IntersectionObserverEntryInit</a><span>, in §2.3</span>
     <li><a href="#dom-intersectionobserverentry-boundingclientrect">attribute for IntersectionObserverEntry</a><span>, in §2.3</span>
    </ul>
   <li><a href="#dom-intersectionobserver-callback-slot">[[callback]]</a><span>, in §3.1.3</span>
   <li><a href="#compute-the-intersection">compute the intersection</a><span>, in §3.2.4</span>
   <li><a href="#dom-intersectionobserver-disconnect">disconnect()</a><span>, in §2.2</span>
   <li><a href="#intersectionobserver-implicit-root">implicit root</a><span>, in §2.2</span>
   <li><a href="#intersectionobserver">IntersectionObserver</a><span>, in §2.2</span>
   <li><a href="#intersection-observer">Intersection Observer</a><span>, in §2</span>
   <li><a href="#callbackdef-intersectionobservercallback">IntersectionObserverCallback</a><span>, in §2.1</span>
   <li><a href="#dom-intersectionobserver-intersectionobserver">IntersectionObserver(callback, options)</a><span>, in §2.2</span>
   <li><a href="#intersectionobserverentry">IntersectionObserverEntry</a><span>, in §2.3</span>
   <li><a href="#dictdef-intersectionobserverentryinit">IntersectionObserverEntryInit</a><span>, in §2.3</span>
   <li><a href="#dom-intersectionobserverentry-intersectionobserverentry">IntersectionObserverEntry(intersectionObserverEntryInit)</a><span>, in §2.3</span>
   <li><a href="#dictdef-intersectionobserverinit">IntersectionObserverInit</a><span>, in §2.4</span>
   <li><a href="#intersectionobserverregistration">IntersectionObserverRegistration</a><span>, in §3.1.2</span>
   <li><a href="#document-intersectionobservertaskqueued">IntersectionObserverTaskQueued</a><span>, in §3.1.1</span>
   <li>
    intersectionRatio
    <ul>
     <li><a href="#dom-intersectionobserverentryinit-intersectionratio">dict-member for IntersectionObserverEntryInit</a><span>, in §2.3</span>
     <li><a href="#dom-intersectionobserverentry-intersectionratio">attribute for IntersectionObserverEntry</a><span>, in §2.3</span>
    </ul>
   <li>
    intersectionRect
    <ul>
     <li><a href="#dom-intersectionobserverentryinit-intersectionrect">dict-member for IntersectionObserverEntryInit</a><span>, in §2.3</span>
     <li><a href="#dom-intersectionobserverentry-intersectionrect">attribute for IntersectionObserverEntry</a><span>, in §2.3</span>
    </ul>
   <li><a href="#intersectionobserver-intersection-root">intersection root</a><span>, in §2.2</span>
   <li><a href="#notify-intersection-observers">notify intersection observers</a><span>, in §3.2.2</span>
   <li><a href="#dom-intersectionobserver-observationtargets-slot">[[ObservationTargets]]</a><span>, in §3.1.3</span>
   <li><a href="#dom-intersectionobserverregistration-observer">observer</a><span>, in §3.1.2</span>
   <li><a href="#dom-intersectionobserver-observe">observe(target)</a><span>, in §2.2</span>
   <li><a href="#parse-a-root-margin">parse a root margin</a><span>, in §2.2</span>
   <li><a href="#dom-intersectionobserverregistration-previousthreshold">previousThreshold</a><span>, in §3.1.2</span>
   <li><a href="#intersection-observer-processing-model">Processing Model</a><span>, in §2.4</span>
   <li><a href="#queue-an-intersectionobserverentry">queue an IntersectionObserverEntry</a><span>, in §3.2.3</span>
   <li><a href="#queue-an-intersection-observer-task">queue an intersection observer task</a><span>, in §3.2.1</span>
   <li><a href="#dom-intersectionobserver-queuedentries-slot">[[QueuedEntries]]</a><span>, in §3.1.3</span>
   <li><a href="#dom-element-registeredintersectionobservers-slot">[[RegisteredIntersectionObservers]]</a><span>, in §3.1.2</span>
   <li>
    root
    <ul>
     <li><a href="#dom-intersectionobserver-root">attribute for IntersectionObserver</a><span>, in §2.2</span>
     <li><a href="#dom-intersectionobserverinit-root">dict-member for IntersectionObserverInit</a><span>, in §2.4</span>
    </ul>
   <li>
    rootBounds
    <ul>
     <li><a href="#dom-intersectionobserverentryinit-rootbounds">dict-member for IntersectionObserverEntryInit</a><span>, in §2.3</span>
     <li><a href="#dom-intersectionobserverentry-rootbounds">attribute for IntersectionObserverEntry</a><span>, in §2.3</span>
    </ul>
   <li><a href="#intersectionobserver-root-intersection-rectangle">root intersection rectangle</a><span>, in §2.2</span>
   <li>
    rootMargin
    <ul>
     <li><a href="#dom-intersectionobserver-rootmargin">attribute for IntersectionObserver</a><span>, in §2.2</span>
     <li><a href="#dom-intersectionobserverinit-rootmargin">dict-member for IntersectionObserverInit</a><span>, in §2.4</span>
    </ul>
   <li><a href="#dom-intersectionobserver-rootmargin-slot">[[rootMargin]]</a><span>, in §3.1.3</span>
   <li><a href="#run-the-update-intersection-observations-steps">run the update intersection observations steps</a><span>, in §3.2.5</span>
   <li><a href="#dom-intersectionobserver-takerecords">takeRecords()</a><span>, in §2.2</span>
   <li>
    target
    <ul>
     <li><a href="#intersectionobserver-target">dfn for IntersectionObserver</a><span>, in §2</span>
     <li><a href="#dom-intersectionobserverentryinit-target">dict-member for IntersectionObserverEntryInit</a><span>, in §2.3</span>
     <li><a href="#dom-intersectionobserverentry-target">attribute for IntersectionObserverEntry</a><span>, in §2.3</span>
    </ul>
   <li><a href="#dom-intersectionobserverinit-threshold">threshold</a><span>, in §2.4</span>
   <li><a href="#dom-intersectionobserver-thresholds">thresholds</a><span>, in §2.2</span>
   <li>
    time
    <ul>
     <li><a href="#dom-intersectionobserverentryinit-time">dict-member for IntersectionObserverEntryInit</a><span>, in §2.3</span>
     <li><a href="#dom-intersectionobserverentry-time">attribute for IntersectionObserverEntry</a><span>, in §2.3</span>
    </ul>
   <li><a href="#dom-intersectionobserver-unobserve">unobserve(target)</a><span>, in §2.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[css-syntax-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-syntax-3/#parse-a-list-of-component-values">parse a list of component values</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-values-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-values-3/#percentage-value">&lt;percentage></a>
     <li><a href="https://drafts.csswg.org/css-values-3/#absolute-length">absolute length</a>
     <li><a href="https://drafts.csswg.org/css-values-3/#dimension">dimension</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS2]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css21/box.html#propdef-margin">margin</a>
    </ul>
   <li>
    <a data-link-type="biblio">[cssom-view-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/cssom-view-1/#dom-element-getboundingclientrect">getBoundingClientRect()</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WHATWG-DOM]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#element">Element</a>
     <li><a href="https://dom.spec.whatwg.org/#mutationobserver">MutationObserver</a>
     <li><a href="https://dom.spec.whatwg.org/#dictdef-mutationobserverinit">MutationObserverInit</a>
     <li><a href="https://dom.spec.whatwg.org/#node">Node</a>
     <li><a href="https://dom.spec.whatwg.org/#dom-mutationobserver-observe">observe(target, options)</a>
    </ul>
   <li>
    <a data-link-type="biblio">[geometry-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.fxtf.org/geometry-1/#domrect">DOMRect</a>
     <li><a href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a>
     <li><a href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
     <li><a href="https://heycam.github.io/webidl/#Exposed">Exposed</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
   <dd>Tab Atkins Jr.; Simon Sapin. <a href="http://dev.w3.org/csswg/css-syntax/">CSS Syntax Module Level 3</a>. URL: <a href="http://dev.w3.org/csswg/css-syntax/">http://dev.w3.org/csswg/css-syntax/</a>
   <dt id="biblio-css-values-3">[CSS-VALUES-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/">CSS Values and Units Module Level 3</a>. 29 September 2016. CR. URL: <a href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2">Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. REC. URL: <a href="https://www.w3.org/TR/CSS2">https://www.w3.org/TR/CSS2</a>
   <dt id="biblio-cssom-view-1">[CSSOM-VIEW-1]
   <dd>Simon Pieters. <a href="https://drafts.csswg.org/cssom-view/">CSSOM View Module</a>. URL: <a href="https://drafts.csswg.org/cssom-view/">https://drafts.csswg.org/cssom-view/</a>
   <dt id="biblio-geometry-1">[GEOMETRY-1]
   <dd>Simon Pieters; Dirk Schulze; Rik Cabanier. <a href="http://dev.w3.org/fxtf/geometry/">Geometry Interfaces Module Level 1</a>. URL: <a href="http://dev.w3.org/fxtf/geometry/">http://dev.w3.org/fxtf/geometry/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-whatwg-dom">[WHATWG-DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def"><span class="kt">callback</span> <a class="nv" href="#callbackdef-intersectionobservercallback">IntersectionObserverCallback</a> = <span class="kt">void</span> (<span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#intersectionobserverentry">IntersectionObserverEntry</a>> <a class="nv" href="#dom-intersectionobservercallback-entries">entries</a>, <a class="n" data-link-type="idl-name" href="#intersectionobserver">IntersectionObserver</a> <a class="nv" href="#dom-intersectionobservercallback-observer">observer</a>)

[<a class="nv idl-code" data-link-type="constructor" href="#dom-intersectionobserver-intersectionobserver">Constructor</a>(<a class="n" data-link-type="idl-name" href="#callbackdef-intersectionobservercallback">IntersectionObserverCallback</a> <a class="nv" href="#dom-intersectionobserver-intersectionobserver-callback-options-callback">callback</a>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-intersectionobserverinit">IntersectionObserverInit</a> <a class="nv" href="#dom-intersectionobserver-intersectionobserver-callback-options-options">options</a>),
 <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<span class="n">Window</span>]
<span class="kt">interface</span> <a class="nv" href="#intersectionobserver">IntersectionObserver</a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>? <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Element?" href="#dom-intersectionobserver-root">root</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-intersectionobserver-rootmargin">rootMargin</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">sequence</span>&lt;<span class="kt">double</span>> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="sequence<double>" href="#dom-intersectionobserver-thresholds">thresholds</a>;
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-observe">observe</a>(<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <a class="nv" href="#dom-intersectionobserver-observe-target-target">target</a>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-unobserve">unobserve</a>(<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <a class="nv" href="#dom-intersectionobserver-unobserve-target-target">target</a>);
  <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-disconnect">disconnect</a>();
  <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#intersectionobserverentry">IntersectionObserverEntry</a>> <a class="nv idl-code" data-link-type="method" href="#dom-intersectionobserver-takerecords">takeRecords</a>();
};

[<a class="nv" href="#dom-intersectionobserverentry-intersectionobserverentry">Constructor</a>(<a class="n" data-link-type="idl-name" href="#dictdef-intersectionobserverentryinit">IntersectionObserverEntryInit</a> <a class="nv" href="#dom-intersectionobserverentry-intersectionobserverentry-intersectionobserverentryinit-intersectionobserverentryinit">intersectionObserverEntryInit</a>)]
<span class="kt">interface</span> <a class="nv" href="#intersectionobserverentry">IntersectionObserverEntry</a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMHighResTimeStamp" href="#dom-intersectionobserverentry-time">time</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMRectReadOnly" href="#dom-intersectionobserverentry-rootbounds">rootBounds</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMRectReadOnly" href="#dom-intersectionobserverentry-boundingclientrect">boundingClientRect</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#domrectreadonly">DOMRectReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMRectReadOnly" href="#dom-intersectionobserverentry-intersectionrect">intersectionRect</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">double</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="double" href="#dom-intersectionobserverentry-intersectionratio">intersectionRatio</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="Element" href="#dom-intersectionobserverentry-target">target</a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-intersectionobserverentryinit">IntersectionObserverEntryInit</a> {
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="http://www.w3.org/TR/hr-time/#domhighrestimestamp">DOMHighResTimeStamp</a> <a class="nv" data-type="DOMHighResTimeStamp " href="#dom-intersectionobserverentryinit-time">time</a>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a> <a class="nv" data-type="DOMRectInit " href="#dom-intersectionobserverentryinit-rootbounds">rootBounds</a>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a> <a class="nv" data-type="DOMRectInit " href="#dom-intersectionobserverentryinit-boundingclientrect">boundingClientRect</a>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dictdef-domrectinit">DOMRectInit</a> <a class="nv" data-type="DOMRectInit " href="#dom-intersectionobserverentryinit-intersectionrect">intersectionRect</a>;
  <span class="kt">required</span> <span class="kt">double</span> <a class="nv" data-type="double " href="#dom-intersectionobserverentryinit-intersectionratio">intersectionRatio</a>;
  <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a> <a class="nv" data-type="Element " href="#dom-intersectionobserverentryinit-target">target</a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-intersectionobserverinit">IntersectionObserverInit</a> {
  <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#element">Element</a>?  <a class="nv idl-code" data-default="null" data-link-type="dict-member" data-type="Element?  " href="#dom-intersectionobserverinit-root">root</a> = <span class="kt">null</span>;
  <span class="kt">DOMString</span> <a class="nv idl-code" data-default="&quot;0px&quot;" data-link-type="dict-member" data-type="DOMString " href="#dom-intersectionobserverinit-rootmargin">rootMargin</a> = "0px";
  (<span class="kt">double</span> <span class="kt">or</span> <span class="kt">sequence</span>&lt;<span class="kt">double</span>>) <a class="nv idl-code" data-default="0" data-link-type="dict-member" data-type="(double or sequence<double>) " href="#dom-intersectionobserverinit-threshold">threshold</a> = 0;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Should we use something other than 100ms as <var>timeout</var>?<a href="#issue-bf9a6e46"> ↵ </a></div>
   <div class="issue"> Should we consider making this just post a task instead?<a href="#issue-f67f2718"> ↵ </a></div>
  </div>
  <aside class="dfn-panel" data-for="intersection-observer">
   <b><a href="#intersection-observer">#intersection-observer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersection-observer-1">3. 
Processing Model</a>
    <li><a href="#ref-for-intersection-observer-2">3.4.1. 
HTML Processing Model: Event Loop</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserver-target">
   <b><a href="#intersectionobserver-target">#intersectionobserver-target</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserver-target-1">2.1. 
The IntersectionObserverCallback</a>
    <li><a href="#ref-for-intersectionobserver-target-2">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-intersectionobserver-target-3">(2)</a> <a href="#ref-for-intersectionobserver-target-4">(3)</a> <a href="#ref-for-intersectionobserver-target-5">(4)</a> <a href="#ref-for-intersectionobserver-target-6">(5)</a> <a href="#ref-for-intersectionobserver-target-7">(6)</a> <a href="#ref-for-intersectionobserver-target-8">(7)</a>
    <li><a href="#ref-for-intersectionobserver-target-9">2.4. 
The IntersectionObserverInit dictionary</a>
    <li><a href="#ref-for-intersectionobserver-target-10">3.2.4. 
Compute the Intersection of a Target Element and the Root</a> <a href="#ref-for-intersectionobserver-target-11">(2)</a> <a href="#ref-for-intersectionobserver-target-12">(3)</a> <a href="#ref-for-intersectionobserver-target-13">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-intersectionobservercallback">
   <b><a href="#callbackdef-intersectionobservercallback">#callbackdef-intersectionobservercallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-intersectionobservercallback-1">2.2. 
The IntersectionObserver interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserver">
   <b><a href="#intersectionobserver">#intersectionobserver</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserver-1">2.1. 
The IntersectionObserverCallback</a>
    <li><a href="#ref-for-intersectionobserver-2">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-intersectionobserver-3">(2)</a> <a href="#ref-for-intersectionobserver-4">(3)</a> <a href="#ref-for-intersectionobserver-5">(4)</a> <a href="#ref-for-intersectionobserver-6">(5)</a> <a href="#ref-for-intersectionobserver-7">(6)</a> <a href="#ref-for-intersectionobserver-8">(7)</a> <a href="#ref-for-intersectionobserver-9">(8)</a> <a href="#ref-for-intersectionobserver-10">(9)</a> <a href="#ref-for-intersectionobserver-11">(10)</a> <a href="#ref-for-intersectionobserver-12">(11)</a> <a href="#ref-for-intersectionobserver-13">(12)</a> <a href="#ref-for-intersectionobserver-14">(13)</a> <a href="#ref-for-intersectionobserver-15">(14)</a>
    <li><a href="#ref-for-intersectionobserver-16">3.1.2. 
Element</a>
    <li><a href="#ref-for-intersectionobserver-17">3.1.3. 
IntersectionObserver</a>
    <li><a href="#ref-for-intersectionobserver-18">3.2.2. 
Notify Intersection Observers</a> <a href="#ref-for-intersectionobserver-19">(2)</a>
    <li><a href="#ref-for-intersectionobserver-20">3.2.3. 
Queue an IntersectionObserverEntry</a>
    <li><a href="#ref-for-intersectionobserver-21">3.2.5. 
Run the Update Intersection Observations Steps</a>
    <li><a href="#ref-for-intersectionobserver-22">3.3. 
IntersectionObserver Lifetime</a> <a href="#ref-for-intersectionobserver-23">(2)</a>
    <li><a href="#ref-for-intersectionobserver-24">3.4.1. 
HTML Processing Model: Event Loop</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-intersectionobserver">
   <b><a href="#dom-intersectionobserver-intersectionobserver">#dom-intersectionobserver-intersectionobserver</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-intersectionobserver-1">2.2. 
The IntersectionObserver interface</a>
    <li><a href="#ref-for-dom-intersectionobserver-intersectionobserver-2">3.1.3. 
IntersectionObserver</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-observe">
   <b><a href="#dom-intersectionobserver-observe">#dom-intersectionobserver-observe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-observe-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-observe-2">(2)</a> <a href="#ref-for-dom-intersectionobserver-observe-3">(3)</a>
    <li><a href="#ref-for-dom-intersectionobserver-observe-4">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-unobserve">
   <b><a href="#dom-intersectionobserver-unobserve">#dom-intersectionobserver-unobserve</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-unobserve-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-unobserve-2">(2)</a> <a href="#ref-for-dom-intersectionobserver-unobserve-3">(3)</a>
    <li><a href="#ref-for-dom-intersectionobserver-unobserve-4">3.3. 
IntersectionObserver Lifetime</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-disconnect">
   <b><a href="#dom-intersectionobserver-disconnect">#dom-intersectionobserver-disconnect</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-disconnect-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-disconnect-2">(2)</a>
    <li><a href="#ref-for-dom-intersectionobserver-disconnect-3">3.3. 
IntersectionObserver Lifetime</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-takerecords">
   <b><a href="#dom-intersectionobserver-takerecords">#dom-intersectionobserver-takerecords</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-takerecords-1">2.2. 
The IntersectionObserver interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-root">
   <b><a href="#dom-intersectionobserver-root">#dom-intersectionobserver-root</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-root-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-root-2">(2)</a> <a href="#ref-for-dom-intersectionobserver-root-3">(3)</a> <a href="#ref-for-dom-intersectionobserver-root-4">(4)</a> <a href="#ref-for-dom-intersectionobserver-root-5">(5)</a> <a href="#ref-for-dom-intersectionobserver-root-6">(6)</a> <a href="#ref-for-dom-intersectionobserver-root-7">(7)</a>
    <li><a href="#ref-for-dom-intersectionobserver-root-8">2.3. 
The IntersectionObserverEntry interface</a>
    <li><a href="#ref-for-dom-intersectionobserver-root-9">3.2.2. 
Notify Intersection Observers</a>
    <li><a href="#ref-for-dom-intersectionobserver-root-10">3.2.5. 
Run the Update Intersection Observations Steps</a>
    <li><a href="#ref-for-dom-intersectionobserver-root-11">3.4.1. 
HTML Processing Model: Event Loop</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-rootmargin">
   <b><a href="#dom-intersectionobserver-rootmargin">#dom-intersectionobserver-rootmargin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-rootmargin-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-rootmargin-2">(2)</a> <a href="#ref-for-dom-intersectionobserver-rootmargin-3">(3)</a> <a href="#ref-for-dom-intersectionobserver-rootmargin-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-thresholds">
   <b><a href="#dom-intersectionobserver-thresholds">#dom-intersectionobserver-thresholds</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-thresholds-1">2.2. 
The IntersectionObserver interface</a>
    <li><a href="#ref-for-dom-intersectionobserver-thresholds-2">3.1.2. 
Element</a>
    <li><a href="#ref-for-dom-intersectionobserver-thresholds-3">3.2.5. 
Run the Update Intersection Observations Steps</a> <a href="#ref-for-dom-intersectionobserver-thresholds-4">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserver-intersection-root">
   <b><a href="#intersectionobserver-intersection-root">#intersectionobserver-intersection-root</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserver-intersection-root-1">2. Intersection Observer</a>
    <li><a href="#ref-for-intersectionobserver-intersection-root-2">2.1. 
The IntersectionObserverCallback</a>
    <li><a href="#ref-for-intersectionobserver-intersection-root-3">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-intersectionobserver-intersection-root-4">(2)</a> <a href="#ref-for-intersectionobserver-intersection-root-5">(3)</a> <a href="#ref-for-intersectionobserver-intersection-root-6">(4)</a> <a href="#ref-for-intersectionobserver-intersection-root-7">(5)</a> <a href="#ref-for-intersectionobserver-intersection-root-8">(6)</a> <a href="#ref-for-intersectionobserver-intersection-root-9">(7)</a> <a href="#ref-for-intersectionobserver-intersection-root-10">(8)</a> <a href="#ref-for-intersectionobserver-intersection-root-11">(9)</a>
    <li><a href="#ref-for-intersectionobserver-intersection-root-12">2.3. 
The IntersectionObserverEntry interface</a> <a href="#ref-for-intersectionobserver-intersection-root-13">(2)</a> <a href="#ref-for-intersectionobserver-intersection-root-14">(3)</a>
    <li><a href="#ref-for-intersectionobserver-intersection-root-15">3.2.4. 
Compute the Intersection of a Target Element and the Root</a> <a href="#ref-for-intersectionobserver-intersection-root-16">(2)</a> <a href="#ref-for-intersectionobserver-intersection-root-17">(3)</a>
    <li><a href="#ref-for-intersectionobserver-intersection-root-18">3.2.5. 
Run the Update Intersection Observations Steps</a> <a href="#ref-for-intersectionobserver-intersection-root-19">(2)</a> <a href="#ref-for-intersectionobserver-intersection-root-20">(3)</a> <a href="#ref-for-intersectionobserver-intersection-root-21">(4)</a>
    <li><a href="#ref-for-intersectionobserver-intersection-root-22">3.3. 
IntersectionObserver Lifetime</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserver-implicit-root">
   <b><a href="#intersectionobserver-implicit-root">#intersectionobserver-implicit-root</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserver-implicit-root-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-intersectionobserver-implicit-root-2">(2)</a> <a href="#ref-for-intersectionobserver-implicit-root-3">(3)</a>
    <li><a href="#ref-for-intersectionobserver-implicit-root-4">2.4. 
The IntersectionObserverInit dictionary</a>
    <li><a href="#ref-for-intersectionobserver-implicit-root-5">3.2.5. 
Run the Update Intersection Observations Steps</a> <a href="#ref-for-intersectionobserver-implicit-root-6">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserver-root-intersection-rectangle">
   <b><a href="#intersectionobserver-root-intersection-rectangle">#intersectionobserver-root-intersection-rectangle</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserver-root-intersection-rectangle-1">2.2. 
The IntersectionObserver interface</a>
    <li><a href="#ref-for-intersectionobserver-root-intersection-rectangle-2">2.3. 
The IntersectionObserverEntry interface</a> <a href="#ref-for-intersectionobserver-root-intersection-rectangle-3">(2)</a> <a href="#ref-for-intersectionobserver-root-intersection-rectangle-4">(3)</a>
    <li><a href="#ref-for-intersectionobserver-root-intersection-rectangle-5">3.2.4. 
Compute the Intersection of a Target Element and the Root</a>
    <li><a href="#ref-for-intersectionobserver-root-intersection-rectangle-6">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parse-a-root-margin">
   <b><a href="#parse-a-root-margin">#parse-a-root-margin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parse-a-root-margin-1">2.2. 
The IntersectionObserver interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserverentry">
   <b><a href="#intersectionobserverentry">#intersectionobserverentry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserverentry-1">2.1. 
The IntersectionObserverCallback</a>
    <li><a href="#ref-for-intersectionobserverentry-2">2.2. 
The IntersectionObserver interface</a>
    <li><a href="#ref-for-intersectionobserverentry-3">3.2.3. 
Queue an IntersectionObserverEntry</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-intersectionobserverentryinit">
   <b><a href="#dictdef-intersectionobserverentryinit">#dictdef-intersectionobserverentryinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-intersectionobserverentryinit-1">2.3. 
The IntersectionObserverEntry interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverentry-boundingclientrect">
   <b><a href="#dom-intersectionobserverentry-boundingclientrect">#dom-intersectionobserverentry-boundingclientrect</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverentry-boundingclientrect-1">2.3. 
The IntersectionObserverEntry interface</a> <a href="#ref-for-dom-intersectionobserverentry-boundingclientrect-2">(2)</a> <a href="#ref-for-dom-intersectionobserverentry-boundingclientrect-3">(3)</a> <a href="#ref-for-dom-intersectionobserverentry-boundingclientrect-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverentry-intersectionrect">
   <b><a href="#dom-intersectionobserverentry-intersectionrect">#dom-intersectionobserverentry-intersectionrect</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverentry-intersectionrect-1">2.3. 
The IntersectionObserverEntry interface</a> <a href="#ref-for-dom-intersectionobserverentry-intersectionrect-2">(2)</a> <a href="#ref-for-dom-intersectionobserverentry-intersectionrect-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverentry-intersectionratio">
   <b><a href="#dom-intersectionobserverentry-intersectionratio">#dom-intersectionobserverentry-intersectionratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverentry-intersectionratio-1">2.3. 
The IntersectionObserverEntry interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverentry-rootbounds">
   <b><a href="#dom-intersectionobserverentry-rootbounds">#dom-intersectionobserverentry-rootbounds</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverentry-rootbounds-1">2.3. 
The IntersectionObserverEntry interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverentry-target">
   <b><a href="#dom-intersectionobserverentry-target">#dom-intersectionobserverentry-target</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverentry-target-1">2.3. 
The IntersectionObserverEntry interface</a> <a href="#ref-for-dom-intersectionobserverentry-target-2">(2)</a> <a href="#ref-for-dom-intersectionobserverentry-target-3">(3)</a> <a href="#ref-for-dom-intersectionobserverentry-target-4">(4)</a> <a href="#ref-for-dom-intersectionobserverentry-target-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverentry-time">
   <b><a href="#dom-intersectionobserverentry-time">#dom-intersectionobserverentry-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverentry-time-1">2.3. 
The IntersectionObserverEntry interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-intersectionobserverinit">
   <b><a href="#dictdef-intersectionobserverinit">#dictdef-intersectionobserverinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-intersectionobserverinit-1">2.2. 
The IntersectionObserver interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverinit-root">
   <b><a href="#dom-intersectionobserverinit-root">#dom-intersectionobserverinit-root</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverinit-root-1">2.4. 
The IntersectionObserverInit dictionary</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverinit-rootmargin">
   <b><a href="#dom-intersectionobserverinit-rootmargin">#dom-intersectionobserverinit-rootmargin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverinit-rootmargin-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserverinit-rootmargin-2">(2)</a> <a href="#ref-for-dom-intersectionobserverinit-rootmargin-3">(3)</a>
    <li><a href="#ref-for-dom-intersectionobserverinit-rootmargin-4">2.4. 
The IntersectionObserverInit dictionary</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverinit-threshold">
   <b><a href="#dom-intersectionobserverinit-threshold">#dom-intersectionobserverinit-threshold</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverinit-threshold-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserverinit-threshold-2">(2)</a>
    <li><a href="#ref-for-dom-intersectionobserverinit-threshold-3">2.4. 
The IntersectionObserverInit dictionary</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersection-observer-processing-model">
   <b><a href="#intersection-observer-processing-model">#intersection-observer-processing-model</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersection-observer-processing-model-1">2.1. 
The IntersectionObserverCallback</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-intersectionobservertaskqueued">
   <b><a href="#document-intersectionobservertaskqueued">#document-intersectionobservertaskqueued</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-intersectionobservertaskqueued-1">3.2.1. 
Queue an Intersection Observer Task</a> <a href="#ref-for-document-intersectionobservertaskqueued-2">(2)</a>
    <li><a href="#ref-for-document-intersectionobservertaskqueued-3">3.2.2. 
Notify Intersection Observers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-registeredintersectionobservers-slot">
   <b><a href="#dom-element-registeredintersectionobservers-slot">#dom-element-registeredintersectionobservers-slot</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-registeredintersectionobservers-slot-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-element-registeredintersectionobservers-slot-2">(2)</a> <a href="#ref-for-dom-element-registeredintersectionobservers-slot-3">(3)</a>
    <li><a href="#ref-for-dom-element-registeredintersectionobservers-slot-4">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intersectionobserverregistration">
   <b><a href="#intersectionobserverregistration">#intersectionobserverregistration</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intersectionobserverregistration-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-intersectionobserverregistration-2">(2)</a> <a href="#ref-for-intersectionobserverregistration-3">(3)</a>
    <li><a href="#ref-for-intersectionobserverregistration-4">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverregistration-observer">
   <b><a href="#dom-intersectionobserverregistration-observer">#dom-intersectionobserverregistration-observer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverregistration-observer-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserverregistration-observer-2">(2)</a> <a href="#ref-for-dom-intersectionobserverregistration-observer-3">(3)</a>
    <li><a href="#ref-for-dom-intersectionobserverregistration-observer-4">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserverregistration-previousthreshold">
   <b><a href="#dom-intersectionobserverregistration-previousthreshold">#dom-intersectionobserverregistration-previousthreshold</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserverregistration-previousthreshold-1">2.2. 
The IntersectionObserver interface</a>
    <li><a href="#ref-for-dom-intersectionobserverregistration-previousthreshold-2">3.2.5. 
Run the Update Intersection Observations Steps</a> <a href="#ref-for-dom-intersectionobserverregistration-previousthreshold-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-queuedentries-slot">
   <b><a href="#dom-intersectionobserver-queuedentries-slot">#dom-intersectionobserver-queuedentries-slot</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-queuedentries-slot-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-queuedentries-slot-2">(2)</a>
    <li><a href="#ref-for-dom-intersectionobserver-queuedentries-slot-3">3.2.2. 
Notify Intersection Observers</a> <a href="#ref-for-dom-intersectionobserver-queuedentries-slot-4">(2)</a> <a href="#ref-for-dom-intersectionobserver-queuedentries-slot-5">(3)</a>
    <li><a href="#ref-for-dom-intersectionobserver-queuedentries-slot-6">3.2.3. 
Queue an IntersectionObserverEntry</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-observationtargets-slot">
   <b><a href="#dom-intersectionobserver-observationtargets-slot">#dom-intersectionobserver-observationtargets-slot</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-observationtargets-slot-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-observationtargets-slot-2">(2)</a> <a href="#ref-for-dom-intersectionobserver-observationtargets-slot-3">(3)</a> <a href="#ref-for-dom-intersectionobserver-observationtargets-slot-4">(4)</a> <a href="#ref-for-dom-intersectionobserver-observationtargets-slot-5">(5)</a>
    <li><a href="#ref-for-dom-intersectionobserver-observationtargets-slot-6">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-callback-slot">
   <b><a href="#dom-intersectionobserver-callback-slot">#dom-intersectionobserver-callback-slot</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-callback-slot-1">2.2. 
The IntersectionObserver interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intersectionobserver-rootmargin-slot">
   <b><a href="#dom-intersectionobserver-rootmargin-slot">#dom-intersectionobserver-rootmargin-slot</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intersectionobserver-rootmargin-slot-1">2.2. 
The IntersectionObserver interface</a> <a href="#ref-for-dom-intersectionobserver-rootmargin-slot-2">(2)</a> <a href="#ref-for-dom-intersectionobserver-rootmargin-slot-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="queue-an-intersection-observer-task">
   <b><a href="#queue-an-intersection-observer-task">#queue-an-intersection-observer-task</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-an-intersection-observer-task-1">3.2.3. 
Queue an IntersectionObserverEntry</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="notify-intersection-observers">
   <b><a href="#notify-intersection-observers">#notify-intersection-observers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notify-intersection-observers-1">3.2.1. 
Queue an Intersection Observer Task</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="queue-an-intersectionobserverentry">
   <b><a href="#queue-an-intersectionobserverentry">#queue-an-intersectionobserverentry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-an-intersectionobserverentry-1">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="compute-the-intersection">
   <b><a href="#compute-the-intersection">#compute-the-intersection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-compute-the-intersection-1">3.2.5. 
Run the Update Intersection Observations Steps</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="run-the-update-intersection-observations-steps">
   <b><a href="#run-the-update-intersection-observations-steps">#run-the-update-intersection-observations-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-run-the-update-intersection-observations-steps-1">3.4.1. 
HTML Processing Model: Event Loop</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>